{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\laiyu\\\\Documents\\\\bookshop\\\\bookshop-react-master\\\\webshop-app\\\\src\\\\pages\\\\StorePage.js\",\n    _s = $RefreshSig$();\n\nimport FooterComponent from \"../components/FooterComponent\";\nimport NavbarComponent from \"../components/NavbarComponent\";\nimport AddBookModal from \"../components/book/AddBookModal\";\nimport Breadcrumbs from \"../components/Breadcrumbs\";\nimport BookList from \"../components/book/BookList\";\nimport { Button } from \"react-bootstrap\";\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport \"../css/StorePage.css\";\nimport { BASE_URL } from \"../Constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction StorePage() {\n  _s();\n\n  const [addModalShow, setAddModalShow] = useState(false);\n  const [books, setBooks] = useState([]);\n  const [filterValues, setFilterValues] = useState(null);\n  const [cartItemsNumber, setCartItemsNumber] = useState(0);\n  const [filters, setFilters] = useState({\n    category: [],\n    price_range: \"\",\n    publishing_house: [],\n    minimum_rating: \"\",\n    stock_yes: false,\n    search: \"\",\n    sort: \"none\"\n  });\n\n  const handleChange = event => {\n    const name = event.target.name;\n    const isChecked = event.target.checked;\n\n    if (name === \"price_range\") {\n      setFilters({ ...filters,\n        [name]: event.target.value\n      });\n    } else if (name === \"category\" || name === \"publishing_house\") {\n      if (isChecked) {\n        setFilters({ ...filters,\n          [name]: [...filters[name], event.target.value]\n        });\n      } else {\n        let index = filters[name].indexOf(event.target.value);\n        filters[name].splice(index, 1);\n        setFilters({ ...filters,\n          [name]: filters[name]\n        });\n      }\n    } else if (name === \"stock_yes\") {\n      if (isChecked) {\n        setFilters({ ...filters,\n          [name]: event.target.value\n        });\n      } else {\n        setFilters({ ...filters,\n          stock_yes: false\n        });\n      }\n    }\n  };\n\n  useEffect(() => {\n    const cartItems = JSON.parse(localStorage.getItem(\"items\"));\n    let counter = 0;\n\n    if (cartItems) {\n      for (let i = 0; i < cartItems.length; i++) {\n        counter = counter + cartItems[i].quantity;\n      }\n\n      setCartItemsNumber(counter);\n    }\n  }, []);\n  useEffect(() => {\n    getBooks();\n  }, [filters]);\n\n  const handleReset = () => {\n    setFilters({ ...filters,\n      category: [],\n      price_range: \"\",\n      publishing_house: [],\n      minimum_rating: \"\",\n      stock_yes: false\n    });\n  };\n\n  const getBooks = () => {\n    axios.get(`${BASE_URL}/books`, {\n      params: filters\n    }).then(function (response) {\n      setBooks(response.data.products);\n      setFilterValues(response.data.filters);\n    });\n  };\n\n  const [isAdmin, setIsAdmin] = useState(false);\n  useEffect(() => {\n    localStorage.getItem(\"user_role\") && localStorage.getItem(\"user_role\") === \"admin\" ? setIsAdmin(true) : setIsAdmin(false);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(NavbarComponent, {\n      isAdmin: isAdmin,\n      setIsAdmin: setIsAdmin,\n      cartItemsNumber: cartItemsNumber\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Breadcrumbs, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(BookList, {\n        cartItemsNumber: cartItemsNumber,\n        setCartItemsNumber: setCartItemsNumber,\n        isAdmin: isAdmin,\n        filterValues: filterValues,\n        filters: filters,\n        books: books,\n        setFilters: setFilters,\n        handleChange: handleChange,\n        handleReset: handleReset,\n        getBooks: getBooks\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }, this), isAdmin && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex justify-content-center mb-5 mt-5\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"danger\",\n          onClick: () => setAddModalShow(true),\n          children: \"Add Book\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(AddBookModal, {\n        show: addModalShow,\n        onHide: () => setAddModalShow(false),\n        getBooks: getBooks\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(FooterComponent, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true);\n}\n\n_s(StorePage, \"EZeRy4tT6B2qamRxlbUhT0TYDJs=\");\n\n_c = StorePage;\nexport default StorePage;\n\nvar _c;\n\n$RefreshReg$(_c, \"StorePage\");","map":{"version":3,"sources":["C:/Users/laiyu/Documents/bookshop/bookshop-react-master/webshop-app/src/pages/StorePage.js"],"names":["FooterComponent","NavbarComponent","AddBookModal","Breadcrumbs","BookList","Button","useState","useEffect","axios","BASE_URL","StorePage","addModalShow","setAddModalShow","books","setBooks","filterValues","setFilterValues","cartItemsNumber","setCartItemsNumber","filters","setFilters","category","price_range","publishing_house","minimum_rating","stock_yes","search","sort","handleChange","event","name","target","isChecked","checked","value","index","indexOf","splice","cartItems","JSON","parse","localStorage","getItem","counter","i","length","quantity","getBooks","handleReset","get","params","then","response","data","products","isAdmin","setIsAdmin"],"mappings":"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","sourcesContent":["import FooterComponent from \"../components/FooterComponent\";\r\nimport NavbarComponent from \"../components/NavbarComponent\";\r\nimport AddBookModal from \"../components/book/AddBookModal\";\r\nimport Breadcrumbs from \"../components/Breadcrumbs\";\r\nimport BookList from \"../components/book/BookList\";\r\nimport { Button } from \"react-bootstrap\";\r\nimport { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nimport \"../css/StorePage.css\";\r\nimport { BASE_URL } from \"../Constants\";\r\n\r\nfunction StorePage() {\r\n    const [addModalShow, setAddModalShow] = useState(false);\r\n    const [books, setBooks] = useState([]);\r\n    const [filterValues, setFilterValues] = useState(null);\r\n    const [cartItemsNumber, setCartItemsNumber] = useState(0);\r\n    const [filters, setFilters] = useState({\r\n        category: [],\r\n        price_range: \"\",\r\n        publishing_house: [],\r\n        minimum_rating: \"\",\r\n        stock_yes: false,\r\n        search: \"\",\r\n        sort: \"none\"\r\n    });\r\n\r\n    const handleChange = (event) => {\r\n        const name = event.target.name;\r\n        const isChecked = event.target.checked;\r\n        if (name === \"price_range\") {\r\n            setFilters({ ...filters, [name]: event.target.value });\r\n        } else if (name === \"category\" || name === \"publishing_house\") {\r\n            if (isChecked) {\r\n                setFilters({\r\n                    ...filters,\r\n                    [name]: [...filters[name], event.target.value]\r\n                });\r\n            } else {\r\n                let index = filters[name].indexOf(event.target.value);\r\n                filters[name].splice(index, 1);\r\n                setFilters({ ...filters, [name]: filters[name] });\r\n            }\r\n        } else if (name === \"stock_yes\") {\r\n            if (isChecked) {\r\n                setFilters({ ...filters, [name]: event.target.value });\r\n            } else {\r\n                setFilters({ ...filters, stock_yes: false });\r\n            }\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        const cartItems = JSON.parse(localStorage.getItem(\"items\"));\r\n        let counter = 0;\r\n        if (cartItems) {\r\n            for (let i = 0; i < cartItems.length; i++) {\r\n                counter = counter + cartItems[i].quantity;\r\n            }\r\n            setCartItemsNumber(counter);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        getBooks();\r\n    }, [filters]);\r\n\r\n    const handleReset = () => {\r\n        setFilters({\r\n            ...filters,\r\n            category: [],\r\n            price_range: \"\",\r\n            publishing_house: [],\r\n            minimum_rating: \"\",\r\n            stock_yes: false\r\n        });\r\n    };\r\n\r\n    const getBooks = () => {\r\n        axios\r\n            .get(`${BASE_URL}/books`, { params: filters })\r\n            .then(function (response) {\r\n                setBooks(response.data.products);\r\n                setFilterValues(response.data.filters);\r\n            });\r\n    };\r\n\r\n    const [isAdmin, setIsAdmin] = useState(false);\r\n    useEffect(() => {\r\n        localStorage.getItem(\"user_role\") &&\r\n        localStorage.getItem(\"user_role\") === \"admin\"\r\n            ? setIsAdmin(true)\r\n            : setIsAdmin(false);\r\n    }, []);\r\n\r\n    return (\r\n        <>\r\n            <NavbarComponent\r\n                isAdmin={isAdmin}\r\n                setIsAdmin={setIsAdmin}\r\n                cartItemsNumber={cartItemsNumber}\r\n            />\r\n            <>\r\n                <Breadcrumbs />\r\n                <BookList\r\n                    cartItemsNumber={cartItemsNumber}\r\n                    setCartItemsNumber={setCartItemsNumber}\r\n                    isAdmin={isAdmin}\r\n                    filterValues={filterValues}\r\n                    filters={filters}\r\n                    books={books}\r\n                    setFilters={setFilters}\r\n                    handleChange={handleChange}\r\n                    handleReset={handleReset}\r\n                    getBooks={getBooks}\r\n                />\r\n                {isAdmin && (\r\n                    <div className=\"d-flex justify-content-center mb-5 mt-5\">\r\n                        <Button\r\n                            variant=\"danger\"\r\n                            onClick={() => setAddModalShow(true)}\r\n                        >\r\n                            Add Book\r\n                        </Button>\r\n                    </div>\r\n                )}\r\n                <AddBookModal\r\n                    show={addModalShow}\r\n                    onHide={() => setAddModalShow(false)}\r\n                    getBooks={getBooks}\r\n                />\r\n                <FooterComponent />\r\n            </>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default StorePage;\r\n"]},"metadata":{},"sourceType":"module"}